import { ArrowRightIcon, MoreHorizontalIcon } from '@/components/icons'
import { cn } from '@/lib/utils'
import { mergeProps } from '@base-ui/react/merge-props'
import { useRender } from '@base-ui/react/use-render'
import type { ComponentProps } from 'react'

function Breadcrumb({ className, ...props }: ComponentProps<'nav'>) {
	return <nav aria-label='breadcrumb' data-slot='breadcrumb' className={cn(className)} {...props} />
}

function BreadcrumbList({ className, ...props }: ComponentProps<'ol'>) {
	return (
		<ol
			data-slot='breadcrumb-list'
			className={cn('flex flex-wrap items-center gap-1.5 text-xs/relaxed break-words text-muted-foreground', className)}
			{...props}
		/>
	)
}

function BreadcrumbItem({ className, ...props }: ComponentProps<'li'>) {
	return <li data-slot='breadcrumb-item' className={cn('inline-flex items-center gap-1', className)} {...props} />
}

function BreadcrumbLink({ className, render, ...props }: useRender.ComponentProps<'a'>) {
	return useRender({
		defaultTagName: 'a',
		props: mergeProps<'a'>(
			{
				className: cn('transition-colors hover:text-foreground', className),
			},
			props,
		),
		render,
		state: {
			slot: 'breadcrumb-link',
		},
	})
}

function BreadcrumbPage({ className, ...props }: ComponentProps<'span'>) {
	return (
		<span
			data-slot='breadcrumb-page'
			role='link'
			aria-disabled='true'
			aria-current='page'
			className={cn('font-normal text-foreground', className)}
			{...props}
		/>
	)
}

function BreadcrumbSeparator({ children, className, ...props }: ComponentProps<'li'>) {
	return (
		<li
			data-slot='breadcrumb-separator'
			role='presentation'
			aria-hidden='true'
			className={cn('[&>svg]:size-3.5', className)}
			{...props}
		>
			{children ?? <ArrowRightIcon className='size-3.5' />}
		</li>
	)
}

function BreadcrumbEllipsis({ className, ...props }: ComponentProps<'span'>) {
	return (
		<span
			data-slot='breadcrumb-ellipsis'
			role='presentation'
			aria-hidden='true'
			className={cn('flex size-4 items-center justify-center [&>svg]:size-3.5', className)}
			{...props}
		>
			<MoreHorizontalIcon className='size-3.5' />
			<span className='sr-only'>More</span>
		</span>
	)
}

export {
	Breadcrumb,
	BreadcrumbList,
	BreadcrumbItem,
	BreadcrumbLink,
	BreadcrumbPage,
	BreadcrumbSeparator,
	BreadcrumbEllipsis,
}
